{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "üü¢ DEV: Iniciar (con archivado de logs)",
      "type": "shell",
      "command": "./scripts/pm2-start.sh",
      "args": ["dev"],
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üî¥ DEV: Detener",
      "type": "shell",
      "command": "./scripts/pm2-stop.sh",
      "args": ["dev"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üîÑ DEV: Reiniciar (Stop + Start con logs limpios)",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "./scripts/pm2-stop.sh dev && sleep 1 && ./scripts/pm2-start.sh dev"],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üü¢ PROD: Iniciar (con archivado de logs)",
      "type": "shell",
      "command": "./scripts/pm2-start.sh",
      "args": ["prod"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üî¥ PROD: Detener",
      "type": "shell",
      "command": "./scripts/pm2-stop.sh",
      "args": ["prod"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üèóÔ∏è PROD: Build + Deploy + Reiniciar",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "echo 'üèóÔ∏è Building for production...' && npm run build && echo 'üîÑ Restarting production...' && ./scripts/pm2-stop.sh prod && sleep 2 && ./scripts/pm2-start.sh prod && echo '‚úÖ Production deployed!'"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üîÑ PROD: Reiniciar (Stop + Start con logs limpios)",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "./scripts/pm2-stop.sh prod && sleep 2 && ./scripts/pm2-start.sh prod"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üßπ Limpiar Logs PM2 (7 d√≠as)",
      "type": "shell",
      "command": "./scripts/pm2-clean-logs.sh",
      "args": ["7"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üßπ Limpiar Logs PM2 (30 d√≠as)",
      "type": "shell",
      "command": "./scripts/pm2-clean-logs.sh",
      "args": ["30"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üìä Estado PM2 (Todos los procesos)",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "echo 'üë§ Procesos usuario kava:' && pm2 status 2>/dev/null || echo 'Sin procesos' && echo '' && echo 'üë§ Procesos usuario www-data:' && sudo -u www-data pm2 status 2>/dev/null || echo 'Sin procesos'"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üèóÔ∏è Build Solo (sin deploy)",
      "type": "shell",
      "command": "npm",
      "args": ["run", "build"],
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üìã DEV: Ver Logs (√∫ltimas 20 l√≠neas)",
      "type": "shell",
      "command": "pm2",
      "args": ["logs", "cuentassik-dev", "--lines", "20", "--nostream"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üìã DEV: Ver Logs (tiempo real)",
      "type": "shell",
      "command": "pm2",
      "args": ["logs", "cuentassik-dev"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üìã PROD: Ver Logs (√∫ltimas 20 l√≠neas)",
      "type": "shell",
      "command": "sudo",
      "args": ["-u", "www-data", "pm2", "logs", "cuentassik-prod", "--lines", "20", "--nostream"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "üìã PROD: Ver Logs (tiempo real)",
      "type": "shell",
      "command": "sudo",
      "args": ["-u", "www-data", "pm2", "logs", "cuentassik-prod"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ÔøΩ Ver Logs Archivados",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "echo 'üìÅ Logs archivados:' && ls -lah logs/archive/ 2>/dev/null || echo 'No hay logs archivados a√∫n' && echo '' && echo 'üíæ Espacio usado por logs:' && du -sh logs/ 2>/dev/null || echo 'Directorio logs no existe'"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ÔøΩ Abrir Testing Dual-Flow",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "echo 'üöÄ Testing Dual-Flow disponible en:' && echo '   http://localhost:3001/dual-flow/testing' && echo '' && echo 'üìä Estado actual:' && pm2 list | grep cuentassik-dev || echo 'Proceso dev no est√° ejecut√°ndose'"],
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ÔøΩ Verificar Sistema Completo",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "echo 'üîç VERIFICACI√ìN SISTEMA COMPLETO' && echo '=================================' && echo '' && echo 'üë§ Procesos PM2:' && (pm2 list 2>/dev/null | grep -E '(online|stopped)' || echo 'Sin procesos kava') && (sudo -u www-data pm2 list 2>/dev/null | grep -E '(online|stopped)' || echo 'Sin procesos www-data') && echo '' && echo 'üìÅ Logs archivados:' && (ls -1 logs/archive/ 2>/dev/null | wc -l && echo ' archivos') || echo '0 archivos' && echo '' && echo 'üåê URLs disponibles:' && echo '  DEV:  http://localhost:3001' && echo '  PROD: http://localhost:3000' && echo '  TEST: http://localhost:3001/dual-flow/testing'"],
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    }
  ]
}
