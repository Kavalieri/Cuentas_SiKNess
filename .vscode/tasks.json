{
  "version": "2.0.0",
  "tasks": [
    // ========================================
    // ğŸ® PM2 - GESTIÃ“N DE PROCESOS (LIMPIA)
    // ========================================
    {
      "label": "ğŸŸ¢ DEV: Iniciar (con archivado de logs)",
      "type": "shell",
      "command": "./scripts/PM2_build_and_deploy_and_dev/pm2-dev-start.sh",
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ”´ DEV: Detener",
      "type": "shell",
      "command": "./scripts/PM2_build_and_deploy_and_dev/pm2-dev-stop.sh",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ”„ DEV: Reiniciar (Stop + Start con logs limpios)",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "./scripts/PM2_build_and_deploy_and_dev/pm2-dev-stop.sh && sleep 1 && ./scripts/PM2_build_and_deploy_and_dev/pm2-dev-start.sh"],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸŸ¢ PROD: Iniciar (con archivado de logs)",
      "type": "shell",
      "command": "./scripts/PM2_build_and_deploy_and_dev/pm2-prod-start.sh",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ”´ PROD: Detener",
      "type": "shell",
      "command": "./scripts/PM2_build_and_deploy_and_dev/pm2-prod-stop.sh",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ”„ PROD: Reiniciar (Stop + Start con logs limpios)",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "./scripts/PM2_build_and_deploy_and_dev/pm2-prod-stop.sh && sleep 2 && ./scripts/PM2_build_and_deploy_and_dev/pm2-prod-start.sh"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ—ï¸ PROD: Build + Deploy + Reiniciar",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/PM2_build_and_deploy_and_dev/build-and-deploy.sh",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    // ========================================
    // ğŸ“Š PM2 - MONITOREO Y LOGS
    // ========================================
    {
      "label": "ğŸ“Š Estado PM2 General",
      "type": "shell",
      "command": "./scripts/PM2_build_and_deploy_and_dev/pm2-status.sh",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ“‹ DEV: Ver Logs (Ãºltimas 50 lÃ­neas)",
      "type": "shell",
      "command": "pm2",
      "args": ["logs", "cuentassik-dev", "--lines", "50", "--nostream"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸš€ DEV: Consola en Tiempo Real",
      "type": "shell",
      "command": "pm2",
      "args": ["logs", "cuentassik-dev", "--timestamp"],
      "isBackground": true,
      "group": "build",
      "presentation": {
        "echo": false,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ“‹ PROD: Ver Logs (Ãºltimas 50 lÃ­neas)",
      "type": "shell",
      "command": "pm2",
      "args": ["logs", "cuentassik-prod", "--lines", "50", "--nostream"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸš€ PROD: Consola en Tiempo Real",
      "type": "shell",
      "command": "pm2",
      "args": ["logs", "cuentassik-prod", "--timestamp"],
      "isBackground": true,
      "group": "build",
      "presentation": {
        "echo": false,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    // ========================================
    // ğŸ§¹ PM2 - MANTENIMIENTO DE LOGS
    // ========================================
    {
      "label": "ğŸ§¹ Limpiar Logs PM2 (7 dÃ­as)",
      "type": "shell",
      "command": "./scripts/PM2_build_and_deploy_and_dev/pm2-clean-logs.sh",
      "args": ["7"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ§¹ Limpiar Logs PM2 (30 dÃ­as)",
      "type": "shell",
      "command": "./scripts/PM2_build_and_deploy_and_dev/pm2-clean-logs.sh",
      "args": ["30"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    // ========================================
    // ğŸ—ï¸ BUILD Y HERRAMIENTAS
    // ========================================
    {
      "label": "ğŸ—ï¸ Build Solo (sin deploy)",
      "type": "shell",
      "command": "bash",
      "args": ["-c", "echo 'ğŸ§¹ Cleaning previous build...' && rm -rf .next && echo 'ğŸ—ï¸ Building for production...' && npm run build"],
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    // ========================================
    // ğŸ—„ï¸ MIGRACIONES - CREACIÃ“N Y GESTIÃ“N
    // ========================================
    {
      "label": "â• Crear Nueva MigraciÃ³n",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/migrations/create_migration.sh",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ“Š Ver Estado de Migraciones",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/migrations/migration_status.sh",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ” Comparar Migraciones entre Entornos",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/migrations/diff_migrations.sh",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    // ========================================
    // ğŸ”§ MIGRACIONES - APLICAR
    // ========================================
    {
      "label": "ğŸ”§ DEV: Aplicar MigraciÃ³n EspecÃ­fica",
      "type": "shell",
      "command": "bash",
      "args": [
        "-c",
        "read -p 'ğŸ“„ Nombre del archivo (ej: 20251101_120000_add_feature.sql): ' FILENAME && ${workspaceFolder}/scripts/migrations/apply_migration.sh dev \"$FILENAME\""
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    {
      "label": "ï¿½ PROD: Aplicar MigraciÃ³n EspecÃ­fica",
      "type": "shell",
      "command": "bash",
      "args": [
        "-c",
        "read -p 'âš ï¸  PRODUCCIÃ“N - Archivo (ej: 20251101_120000_add_feature.sql): ' FILENAME && read -p 'Â¿Confirmas aplicar en PROD? (yes/no): ' CONFIRM && [[ \"$CONFIRM\" == \"yes\" ]] && ${workspaceFolder}/scripts/migrations/apply_migration.sh prod \"$FILENAME\" || echo 'âŒ OperaciÃ³n cancelada'"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ§ª TEST: Aplicar MigraciÃ³n EspecÃ­fica",
      "type": "shell",
      "command": "bash",
      "args": [
        "-c",
        "read -p 'ğŸ§ª TEST BASELINE - Archivo (ej: 20251101_120000_add_feature.sql): ' FILENAME && ${workspaceFolder}/scripts/migrations/apply_migration.sh test \"$FILENAME\""
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    {
      "label": "â†©ï¸ Rollback: Marcar MigraciÃ³n como Revertida",
      "type": "shell",
      "command": "bash",
      "args": [
        "-c",
        "read -p 'ğŸ”„ Entorno (dev/prod/test): ' ENV && read -p 'ğŸ“„ Nombre del archivo: ' FILENAME && ${workspaceFolder}/scripts/migrations/rollback_migration.sh \"$ENV\" \"$FILENAME\""
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    // ========================================
    // ï¿½ TYPES - AUTO-GENERACIÃ“N
    // ========================================
    {
      "label": "ğŸ”„ Regenerar Types (DEV)",
      "type": "shell",
      "command": "npm",
      "args": ["run", "types:generate:dev"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    {
      "label": "ğŸ”„ Regenerar Types (PROD)",
      "type": "shell",
      "command": "npm",
      "args": ["run", "types:generate:prod"],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false,
        "clear": true
      },
      "problemMatcher": []
    },
    // ========================================
    // ğŸ—„ï¸ DATABASE - SINCRONIZACIÃ“N Y AUDITORÃA
    // ========================================
    {
      "label": " Verificar Estado Bases de Datos",
      "type": "shell",
      "command": "bash",
      "args": [
        "-c",
        "echo 'ğŸ”µ DEV Database:' && psql -h 127.0.0.1 -U cuentassik_user -d cuentassik_dev -c 'SELECT COUNT(*) as total_transactions FROM transactions; SELECT COUNT(*) as total_profiles FROM profiles; SELECT COUNT(*) as total_households FROM households;' && echo '' && echo 'ğŸ”´ PROD Database:' && psql -h 127.0.0.1 -U cuentassik_user -d cuentassik_prod -c 'SELECT COUNT(*) as total_transactions FROM transactions; SELECT COUNT(*) as total_profiles FROM profiles; SELECT COUNT(*) as total_households FROM households;'"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    }
  ]
}
